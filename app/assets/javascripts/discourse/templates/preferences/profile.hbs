{{#if canEditName}}
  <div class="control-group pref-name">
    <label class="control-label">{{i18n 'user.name.title'}}</label>
    <div class="controls">
      {{#if model.can_edit_name}}
        {{text-field value=newNameInput classNames="input-xxlarge"}}
      {{else}}
        <span class='static'>{{model.name}}</span>
      {{/if}}
    </div>
    <div class='instructions'>
      {{nameInstructions}}
    </div>
  </div>
{{/if}}

{{#if canSelectTitle}}
  <div class="control-group pref-title">
    <label class="control-label">{{i18n 'user.title.title'}}</label>
    <div class="controls">
      <span class="static">{{model.title}}</span>
      {{#link-to "preferences.badgeTitle" class="btn btn-small pad-left no-text"}}{{fa-icon "pencil"}}{{/link-to}}
    </div>
  </div>
{{/if}}

<div class="control-group pref-avatar">
  <label class="control-label">{{i18n 'user.avatar.title'}}</label>
  <div class="controls">
    {{! we want the "huge" version even though we're downsizing it to "large" in CSS }}
    {{bound-avatar model "huge"}}
    {{#unless siteSettings.sso_overrides_avatar}}
      {{d-button action="showAvatarSelector" class="pad-left" icon="pencil"}}
    {{/unless}}
  </div>
</div>

{{#if siteSettings.allow_profile_backgrounds}}
  <div class="control-group pref-profile-bg">
    <label class="control-label">{{i18n 'user.change_profile_background.title'}}</label>
    <div class="controls">
      {{image-uploader imageUrl=model.profile_background type="profile_background"}}
    </div>
    <div class='instructions'>
      {{i18n 'user.change_profile_background.instructions'}}
    </div>
  </div>

  <div class="control-group pref-profile-bg">
    <label class="control-label">{{i18n 'user.change_card_background.title'}}</label>
    <div class="controls">
      {{image-uploader imageUrl=model.card_background type="card_background"}}
    </div>
    <div class='instructions'>
      {{i18n 'user.change_card_background.instructions'}}
    </div>
  </div>
{{/if}}

{{#if canChangeBio}}
<div class="control-group pref-bio">
  <label class="control-label">{{i18n 'user.bio'}}</label>
  <div class="controls bio-composer">
    {{d-editor value=model.bio_raw}}
  </div>
</div>
{{/if}}

<div class="control-group pref-location">
  <label class="control-label">{{i18n 'user.location'}}</label>
  <div class="controls">
    {{input type="text" value=model.location class="input-xxlarge" id='edit-location'}}
  </div>
</div>

<div class="control-group pref-website">
  <label class="control-label">{{i18n 'user.website'}}</label>
  <div class="controls">
    {{input type="text" value=model.website class="input-xxlarge"}}
  </div>
</div>

{{#each userFields as |uf|}}
  <div class="control-group">
    {{user-field field=uf.field value=uf.value}}
  </div>
{{/each}}
<div class='clearfix'></div>

<div class="control-group pref-card-badge">
  <label class="control-label">{{i18n 'user.card_badge.title'}}</label>
  <div class="controls">
    {{#if model.card_image_badge}}
      {{icon-or-image model.card_image_badge}}
    {{/if}}
    {{#link-to "preferences.card-badge" class="btn btn-small pad-left no-text"}}{{fa-icon "pencil"}}{{/link-to}}
  </div>
</div>

{{plugin-outlet name="user-custom-preferences" args=(hash model=model)}}

<br/>

{{plugin-outlet name="user-custom-controls" args=(hash model=model)}}

<div class="control-group save-button">
  <div class="controls">
    {{partial 'user/preferences/save-button'}}
  </div>
</div>
